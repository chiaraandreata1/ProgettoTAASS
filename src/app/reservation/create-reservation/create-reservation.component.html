<h3>Create Reservation</h3>
<div [hidden]="submitted" style="width: 300px;">
  <form (ngSubmit)="onSubmit()">
    <div>
      <p>SPORT RESERVATION:</p>
      <mat-radio-group required [(ngModel)]="sportReservation" name='valueSport' (ngModelChange)="checkRadioInputs()" aria-label="SPORT RESERVATION">
        <mat-radio-button value="tennis">Tennis</mat-radio-button>
        <mat-radio-button value="padel">Padel</mat-radio-button>
      </mat-radio-group>
    </div>
    <div *ngIf="sportReservation == 'tennis'">
      <p>PLAYERS NUMBER:</p>
      <mat-radio-group required [(ngModel)]="numberplayers" name='valueNumberPlayers' (ngModelChange)="resetInputPlayers()" aria-label="PLAYERS NUMBER">
        <mat-radio-button value=2>2</mat-radio-button>
        <mat-radio-button value=4>4</mat-radio-button>
      </mat-radio-group>
    </div>
    <div [formGroup]="playersForm" *ngFor="let player of arrplayers; let i = index">
      <mat-form-field appearance="fill">
        <mat-label>{{player}}</mat-label>
        <input type="text" matInput [formControlName]=player [matAutocomplete]="auto" (ngModelChange)="playerlistready()" required>
        <button *ngIf="playersForm.controls[player].value" matSuffix mat-icon-button aria-label="Clear" (click)="enableInputPlayer(playersForm.controls[player])">
          <mat-icon>close</mat-icon>
        </button>
        <mat-error *ngIf="playersForm.controls[player].hasError('userInvalid')">Select one suggestion</mat-error>
        <mat-autocomplete #auto="matAutocomplete" [displayWith]="displayFn">
          <ng-container *ngIf="playersForm.controls[player].value && playersForm.controls[player].value.length>1">
            <mat-option *ngFor="let option of filtersOptions[i] | async" [value]="option" (click)="disableInputPlayer(playersForm.controls[player])">
              {{option.username}}
            </mat-option>
          </ng-container>
        </mat-autocomplete>
      </mat-form-field>
    </div>
    <div *ngIf="listplayersready && numberplayers>0">
      <label for="dateReservation">Choose your date</label>
      <div class="input-group date">
        <mat-form-field>
          <input readonly='true' matInput [matDatepicker] = "picker" name="dateReservation" id="dateReservation" [min]="minDate" [max]="maxDate"
                 [(ngModel)]="reservation.dateReservation"  [formControl]="dateReservation" (ngModelChange)="reloadData()" required>
          <mat-datepicker-toggle matSuffix [for] = "picker"></mat-datepicker-toggle>
          <mat-datepicker #picker></mat-datepicker>
        </mat-form-field>
      </div>

      <ng-container *ngIf="reservationsNOTAvailable && searchready">
        <ng-container *ngFor="let hour of hoursAvailable" style="width: 300px;">
          <ng-container *ngFor="let court of courts | async" style="width: 300px;">
            <ng-container *ngIf="arrNOTAvailableForHours[hour-9]!=undefined && court.type == sportReservation">
              <ng-container *ngIf="!arrNOTAvailableForHours[hour-9].includes(court.id); then ButtonAvailable else ButtonNotAvailable"></ng-container>
              <ng-template #ButtonAvailable>
                <button mat-raised-button color="primary" type="submit" (click)="createReservation(sportReservation, dateReservation.value, hour, court.id, court.type)">{{hour}}.00-Court{{court.id}}</button>
              </ng-template>
              <ng-template #ButtonNotAvailable>
                <button mat-raised-button color="primary" [disabled]="true">{{hour}}.00-Court{{court.id}}</button>
              </ng-template>
            </ng-container>
          </ng-container>
        </ng-container>
      </ng-container>
    </div>
  </form>
  <!-- BOTTONE DEBUGGING
  <button mat-raised-button color="secondary" (click)='show()' >See</button>
  -->

</div>

 <div [hidden]="!submitted">
   <h4>You submitted successfully!</h4>
   <button mat-raised-button color="primary" type="submit" (click)="newReservation()">Add new</button>
 </div>
